{"version":3,"sources":["main.js"],"names":["$","hide","eu","monthStr","selectedCountry","labels","name","lat","lon","query","countryEUArr","forEach","d","i","CountryCode","EU","ajax","url","success","response","records","result","total","dataArray","filter","Month","length","data","dataNC","dataPrev","init","monthArray","monthTotals","totalPrev","totalEUPrev","monthData","totalNC","totalNCEU","totalEU","month","push","_id","_full_text","sum","key","hasOwnProperty","parseInt","x","Date","y","mapMonth","latestRecord","Object","keys","Total","TotalEU","minMonth","d3","min","maxMonth","max","maxMonthStr","getMonth","getFullYear","minMonthStr","maxYear","minYear","text","cumulativeQuery","mapArray","CountryName","centroid_lat","centroid_lon","Math","apply","map","o","grandTotal","grandEUTotal","latestYearArray","m_width","width","height","svg","select","append","attr","bg","on","mapTotalEu","mapTotal","scale","projection","geo","azimuthalEquidistant","center","translate","path","maxCircle","r","sqrt","domain","range","g","json","error","mapdata","topojson","feature","objects","un_world","selectAll","features","enter","id","hover","hover_off","selectCountry","circles_group","circles","country_id","replace","each","index","html","numberFormat","show","latestYearRecord","latestYearQuery","reset","addClass","removeClass","totalYear","between","subtitle","transition","duration","pie","series","update","top2","top5","others","redraw","chart","setVisible","topEU2","topEU5","othersEU","iso","countryData","countries","setData","country","lYear","lTotal","window","resize","w","mousemove","event","m","offset","css","pageX","left","pageY","top","n","parts","toString","split","DEU","SWE","AUT","HUN","NLD","GRC","DNK","Highcharts","Chart","renderTo","type","animation","backgroundColor","plotBackgroundColor","plotBorderWidth","plotShadow","marginBottom","marginLeft","marginRight","marginTop","spacingTop","spacingBottom","spacingLeft","spacingRight","title","credits","enabled","tooltip","pointFormat","plotOptions","size","showInLegend","startAngle","allowPointSelect","cursor","dataLabels","distance","style","color","fontColor","softConnector","connectorColor","format","legend","xAxis","dateTimeLabelFormats","second","minute","hour","day","week","year","yAxis","opposite","gridLineWidth","lineColor","tickColor","tickWidth","formatter","value","font","shared","crosshairs","shadow","borderRadius","borderWidth","useHTML","hideDelay","padding","lineHeight","textAlign","string","tot","points","point","dateFormat","area","fillOpacity","smoothed","lineWidth","strokeOpacity","marker","symbol","radius","states","opacity","offsetY","offsetX","line","fillColor","column","pointPadding","borderColor","document","ready","mapHeight","rightHeight","linePos","position","diff","newHeight","rightWidth","oldVersion","arguments","delay","ob1","ob2","sumObj","obj","el","parseFloat"],"mappings":"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","file":"main.js","sourcesContent":["\n\n//**************************\n// MAP\n//**************************\n\n$('#popup').hide();\n\nvar eu = 0;\n\nvar monthStr = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\nvar selectedCountry = null; \n\nvar labels = [\n{name: 'Mediterranean Sea', lat: 18.2, lon: 34.2}, \n{name: 'Black Sea', lat: 34.4, lon: 43.1}, \n{name: 'North Sea', lat: 2.98, lon: 56.3}, \n{name: 'Norweigen Sea', lat: 0.7, lon: 68.8}, \n{name: 'ATLANTIC OCEAN', lat: -12, lon: 47},\n];\n\nvar query = [{'CountryCode':'ALB','CountryName':'Albania','EU':'0','centroid_lat':'41.1435','centroid_lon':'20.0647','Total':'353','TotalEU':'0'},{'CountryCode':'AUT','CountryName':'Austria','EU':'1','centroid_lat':'47.6','centroid_lon':'13.7833','Total':'50387','TotalEU':'50387'},{'CountryCode':'BEL','CountryName':'Belgium','EU':'1','centroid_lat':'50.6413','centroid_lon':'4.65898','Total':'19384','TotalEU':'19384'},{'CountryCode':'BIH','CountryName':'Bosnia and Herzegovina','EU':'0','centroid_lat':'44.168','centroid_lon':'17.7868','Total':'159','TotalEU':'0'},{'CountryCode':'BGR','CountryName':'Bulgaria','EU':'1','centroid_lat':'42.75','centroid_lon':'25.5','Total':'20353','TotalEU':'20353'},{'CountryCode':'CYP','CountryName':'Cyprus','EU':'1','centroid_lat':'35.0445','centroid_lon':'33.2193','Total':'5661','TotalEU':'5661'},{'CountryCode':'CZE','CountryName':'Czech Republic','EU':'1','centroid_lat':'49.7388','centroid_lon':'15.3368','Total':'501','TotalEU':'501'},{'CountryCode':'DNK','CountryName':'Denmark','EU':'1','centroid_lat':'55.72','centroid_lon':'12.57','Total':'20741','TotalEU':'20741'},{'CountryCode':'EST','CountryName':'Estonia','EU':'1','centroid_lat':'58.6722','centroid_lon':'25.5469','Total':'45','TotalEU':'45'},{'CountryCode':'FIN','CountryName':'Finland','EU':'1','centroid_lat':'62.6741','centroid_lon':'26','Total':'2770','TotalEU':'2770'},{'CountryCode':'FRA','CountryName':'France','EU':'1','centroid_lat':'46.5611','centroid_lon':'2.55544','Total':'20348','TotalEU':'20348'},{'CountryCode':'GBR','CountryName':'United Kingdom','EU':'1','centroid_lat':'52.4292','centroid_lon':'-1.23','Total':'11105','TotalEU':'11105'},{'CountryCode':'DEU','CountryName':'Germany','EU':'1','centroid_lat':'51.5167','centroid_lon':'9.9167','Total':'518326','TotalEU':'518326'},{'CountryCode':'GRC','CountryName':'Greece','EU':'1','centroid_lat':'39','centroid_lon':'22','Total':'20863','TotalEU':'20863'},{'CountryCode':'HRV','CountryName':'Croatia','EU':'1','centroid_lat':'45.1112','centroid_lon':'16.4216','Total':'817','TotalEU':'817'},{'CountryCode':'HUN','CountryName':'Hungary','EU':'1','centroid_lat':'47.1672','centroid_lon':'19.4131','Total':'77256','TotalEU':'77256'},{'CountryCode':'ISL','CountryName':'Iceland','EU':'0','centroid_lat':'65','centroid_lon':'-18','Total':'109','TotalEU':'0'},{'CountryCode':'IRL','CountryName':'Ireland','EU':'1','centroid_lat':'53','centroid_lon':'-8','Total':'633','TotalEU':'633'},{'CountryCode':'ITA','CountryName':'Italy','EU':'1','centroid_lat':'42.9082','centroid_lon':'12.26','Total':'4846','TotalEU':'4846'},{'CountryCode':'LIE','CountryName':'Liechtenstein','EU':'0','centroid_lat':'47.1388','centroid_lon':'9.55447','Total':'21','TotalEU':'0'},{'CountryCode':'LTU','CountryName':'Lithuania','EU':'1','centroid_lat':'55.3347','centroid_lon':'23.8986','Total':'369','TotalEU':'369'},{'CountryCode':'LUX','CountryName':'Luxembourg','EU':'1','centroid_lat':'49.7759','centroid_lon':'6.09343','Total':'1374','TotalEU':'1374'},{'CountryCode':'LVA','CountryName':'Latvia','EU':'1','centroid_lat':'56.8588','centroid_lon':'24.9231','Total':'377','TotalEU':'377'},{'CountryCode':'MKD','CountryName':'The former Yugoslav Republic of Macedonia','EU':'0','centroid_lat':'41.6','centroid_lon':'21.7','Total':'2327','TotalEU':'0'},{'CountryCode':'MLT','CountryName':'Malta','EU':'1','centroid_lat':'35.8833','centroid_lon':'14.5','Total':'1890','TotalEU':'1890'},{'CountryCode':'NLD','CountryName':'Netherlands','EU':'1','centroid_lat':'52.3167','centroid_lon':'5.55','Total':'33897','TotalEU':'33897'},{'CountryCode':'NOR','CountryName':'Norway','EU':'1','centroid_lat':'61.27','centroid_lon':'8.78','Total':'15316','TotalEU':'15316'},{'CountryCode':'POL','CountryName':'Poland','EU':'1','centroid_lat':'52.1224','centroid_lon':'19.4013','Total':'829','TotalEU':'829'},{'CountryCode':'PRT','CountryName':'Portugal','EU':'1','centroid_lat':'39.4362','centroid_lon':'-8','Total':'1047','TotalEU':'1047'},{'CountryCode':'ROU','CountryName':'Romania','EU':'1','centroid_lat':'45.8667','centroid_lon':'25.3','Total':'3809','TotalEU':'3809'},{'CountryCode':'SRB','CountryName':'Serbia (and Kosovo: S\\/RES\\/1244(1999))','EU':'0','centroid_lat':'43.8167','centroid_lon':'21.1333','Total':'11892','TotalEU':'0'},{'CountryCode':'ESP','CountryName':'Spain','EU':'1','centroid_lat':'40.4169','centroid_lon':'-3.7036','Total':'14830','TotalEU':'14830'},{'CountryCode':'SVK','CountryName':'Slovakia','EU':'1','centroid_lat':'48.7062','centroid_lon':'19.4864','Total':'81','TotalEU':'81'},{'CountryCode':'SVN','CountryName':'Slovenia','EU':'1','centroid_lat':'46.1209','centroid_lon':'14.8262','Total':'556','TotalEU':'556'},{'CountryCode':'SWE','CountryName':'Sweden','EU':'1','centroid_lat':'63.0749','centroid_lon':'15.82','Total':'114585','TotalEU':'114585'},{'CountryCode':'CHE','CountryName':'Switzerland','EU':'1','centroid_lat':'46.8333','centroid_lon':'8.333','Total':'15317','TotalEU':'15317'},{'CountryCode':'MNE','CountryName':'Montenegro','EU':'0','centroid_lat':'42.7667','centroid_lon':'19.2167','Total':'3030','TotalEU':'0'}];\n\n// refresh totals in original query\nvar countryEUArr = [];\n\nquery.forEach(function(d,i){\n    countryEUArr[d.CountryCode] = d.EU;\n});\n\n$.ajax({\n    //**************************\n    // DATA SOURCE (LOCAL or CKAN)\n    //**************************\n    // url: 'scripts/data.json', // local data\n    url: 'https://ckanviz.swige.unhcr.org/api/action/datastore_search_sql?sql=SELECT%20*%20from%20%2286b73fc2-223a-41ff-a256-178dd525f33a%22%20order%20by%20%22Month%22%20asc',\n    success: function(response) {\n        var records = response.result.total;\n        var dataArray = response.result.records;\n\n        // filter out any null rows\n        dataArray = dataArray.filter(function(d){\n            return d.Month.length > 0;\n        });\n\n        var data = {};\n        var dataNC = {}; // non-cumulative\n\n        var dataPrev = []; \n        var init = 0;\n        var monthArray = [];\n        var monthTotals = [];\n        var totalPrev = 0;\n        var totalEUPrev = 0;\n        var monthData = {};\n        monthData.totalNC = [];\n        monthData.totalNCEU = [];\n        monthData.total = [];\n        monthData.totalEU = [];\n\n        // parse through data and get cumuative and non-cumulative totals. \n        dataArray.forEach(function(d){\n            var month = d.Month; \n            monthArray.push(month);\n            delete d._id;\n            delete d._full_text;\n\n            if(init > 0 ){\n                data[month+'-01'] = sum(d, dataPrev);            \n            } else {\n                data[month+'-01'] = d;\n            }\n\n            dataNC[month+'-01'] = d;\n            init = 1;\n            dataPrev = data[month+'-01'];\n\n            var total = 0;\n            var totalEU = 0;\n\n            for (var key in d) {\n                if (d.hasOwnProperty(key)) {\n                    if((key!='_id')&&(key!='_full_text')&&(key!='Month')){\n                        total = parseInt(total) + parseInt(d[key]);\n                        if(countryEUArr[key]==1){\n                          totalEU = parseInt(totalEU) + parseInt(d[key]);  \n                      }\n                  }\n              }\n          }\n\n          monthTotals[month+'-01'] = {'totalNC': total, 'totalNCEU': totalEU, 'total': (total + totalPrev), 'totalEU': (totalEU + totalEUPrev)};\n\n          monthData.totalNC.push({x: new Date(month+'-01'), y: total });\n          monthData.totalNCEU.push({x: new Date(month+'-01'), y: totalEU });\n          monthData.total.push({x: new Date(month+'-01'), y: total + totalPrev });\n          monthData.totalEU.push({x: new Date(month+'-01'), y: totalEU + totalEUPrev });\n\n          totalPrev = total + totalPrev;\n          totalEUPrev = totalEU + totalEUPrev;\n\n      });\n\n    var mapMonth = data;\n\n    var latestRecord = mapMonth[Object.keys(mapMonth)[Object.keys(mapMonth).length - 1]];\n\n    // refresh totals in original query\n    query.forEach(function(d,i){\n        d.Total = latestRecord[d.CountryCode];\n        if(d.EU==1){\n            d.TotalEU = latestRecord[d.CountryCode];\n        }\n    });\n\n    var minMonth = d3.min(monthArray, function(d){\n        return d;\n    });\n\n    var maxMonth = d3.max(monthArray, function(d){\n        return d;\n    });\n\n    var maxMonthStr = monthStr[new Date(maxMonth).getMonth()] + ' ' + new Date(maxMonth).getFullYear();\n    var minMonthStr = monthStr[new Date(minMonth).getMonth()] + ' ' + new Date(minMonth).getFullYear();\n    var maxYear = new Date(maxMonth).getFullYear();\n    var minYear = new Date(minMonth).getFullYear();\n\n    $('#latestYear').text(maxYear);\n\n    var cumulativeQuery = query; \n\n    var mapArray = [];\n    // refresh totals in original query\n    cumulativeQuery.forEach(function(d,i){\n\n        var x = {};\n\n        x.Total = latestRecord[d.CountryCode];\n\n        if(d.EU==1){\n            x.TotalEU = latestRecord[d.CountryCode];\n        }\n\n        x.CountryCode = d.CountryCode; \n        x.CountryName = d.CountryName\n        x.EU = d.EU;\n        x.centroid_lat = d.centroid_lat;\n        x.centroid_lon = d.centroid_lon;\n\n        mapArray.push(x);\n\n    });\n\n    var max = Math.max.apply(Math,query.map(function(o){return o.Total;}));\n\n    var grandTotal = d3.sum(query, function(d){\n        return d.Total;\n    });\n\n    var grandEUTotal = d3.sum(query, function(d){\n        return d.TotalEU;\n    });\n\n    // get latest year totals\n    var latestYearArray = dataArray.filter(function(d){\n        return new Date(d.Month).getFullYear() == maxYear;\n    });\n\n\n    var dataPrev = []; \n    var init = 0;\n    var monthArray = [];\n    var data = {};\n\n    var m_width = $('#map').width(),\n    width = $('#map').width(),\n    height = $('#map').height();\n\n    var svg = d3.select('#map').append('svg')\n    .attr('preserveAspectRatio', 'xMidYMid')\n    .attr('viewBox', '0 0 ' + width + ' ' + height)\n    .attr('width', m_width)\n    .attr('height', m_width * height / width);\n\n    var bg = svg.append('rect')\n    .attr('id', 'bg')\n    .attr('width', m_width)\n    .attr('height', m_width * height / width)\n    .attr('opacity', 0)\n    .on('click', function(d){\n       if(eu==1){\n            mapTotalEu();\n       } else {\n            mapTotal();          \n       }\n    });\n\n    var scale = width/1.05;\n\n    var projection = d3.geo.azimuthalEquidistant()\n    .scale(scale)\n    .center([16.8, 50.6])\n    .translate([((width ) / 2), height / 2]);\n\n    var path = d3.geo.path()\n    .projection(projection);\n\n    var maxCircle = 30;\n\n    var r = d3.scale.sqrt()\n    .domain([0, max])\n    .range([0, maxCircle]);\n\n    var g = svg.append('g'); \n\n    d3.json('scripts/world.json', function(error, data) {\n        var mapdata = topojson.feature(data, data.objects.un_world);\n\n        g.append('g')\n        .attr('id', 'countries')\n        .selectAll('path')\n        .data(mapdata.features)\n        .enter()\n        .append('path')\n        .attr('id', function(d) {\n            return 'COU_'+d.id;\n        })\n        .attr('class', 'country')\n        .attr('fill', function(d){if(d.id=='SYR'){return '#dbcdcc';}else{return '#d6d8d7';}})\n        .attr('stroke', '#bdbfbe')\n        .attr('stroke-width', 1)\n        .attr('d', path)\n        .on('mouseover', function() {\n            hover(this.id);\n        })\n        .on('mouseout', function() {\n            hover_off(this.id);\n        })\n        .on('click', function(d){ return selectCountry(d.id) });\n\n        mapTotal();\n\n    });\n\n    var circles_group = svg.append('g'); \n\n    var circles = circles_group.selectAll('circle')\n    .data(mapArray)\n    .enter()\n    .append('circle')\n    .attr('cx', function (d) { return projection([d.centroid_lon, d.centroid_lat ])[0] })\n    .attr('cy', function (d) { return projection([d.centroid_lon, d.centroid_lat ])[1] })\n    .attr('r', function (d) { return r(d.Total) })\n    .attr('id', function(d) {\n        return d.CountryCode;\n    })\n    .attr('stroke', '#b96e93')\n    .attr('stroke-width', 1.5)\n    .attr('class', 'circle')\n    .attr('fill', '#b96e93')\n    .attr('fill-opacity', 0.4)\n    .on('mouseover', function() {\n        hover('COU_'+this.id);\n    })\n    .on('mouseout', function() {\n        hover_off('COU_'+this.id);\n    })\n    .on('click', function(d){ return selectCountry(d.CountryCode) });\n\n    // add some labels\n    svg.selectAll('.placelabel')\n    .data(labels)\n    .enter()\n    .append('text')\n    .attr('class', 'placelabel')\n    .attr('transform', function(d) { return 'translate(' + projection([d.lat,d.lon]) + ')'; })\n    .attr('dy', '.30em')\n    .attr('text-anchor', 'middle')\n    .text(function(d) { return d.name });\n\n    function hover(country_id){\n        var id = country_id.replace('COU_', '');\n\n        if(eu==1){\n           $.each(mapArray, function (index, data) {\n            if((data.CountryCode == id)&&(data.EU==1)){\n               d3.selectAll('#'+country_id)\n               .attr('class', 'hover');\n\n               d3.selectAll('#'+id)\n               .attr('class', 'hover_circle');\n\n               $('#popup .name').html(data.CountryName);\n               $('#popup .figure').html(numberFormat(data.Total));\n               $('#popup').show();\n\n           }\n       });\n       } else {\n           $.each(mapArray, function (index, data) {\n\n            if(data.CountryCode == id){\n\n               d3.selectAll('#'+country_id)\n               .attr('class', 'hover');\n\n               d3.selectAll('#'+id)\n               .attr('class', 'hover_circle');\n\n               $('#popup .name').html(data.CountryName);\n               $('#popup .figure').html(numberFormat(data.Total));\n               $('#popup').show();\n           }\n       });\n       }\n    }\n\n    // parse through data and get latest year totals\n    latestYearArray.forEach(function(d){\n        var month = d.Month; \n        delete d._id;\n        // delete d.Month;\n        delete d._full_text;\n        if(init > 0 ){\n            data[month+'-01'] = sum(d, dataPrev);            \n        } else {\n            data[month+'-01'] = d;\n        }\n        init = 1;\n        dataPrev = data[month+'-01'];\n    });\n\n    delete latestRecord.Month;\n    var latestYearRecord = data[Object.keys(data)[Object.keys(data).length - 1]];\n\n    var latestYearQuery = query;\n\n        // refresh totals in original query\n        latestYearQuery.forEach(function(d,i){\n            d.Total = latestYearRecord[d.CountryCode];\n            if(d.EU==1){\n                d.TotalEU = latestYearRecord[d.CountryCode];\n            }\n        });\n\n        function hover_off(country_id){\n            $('#popup').hide();\n            var id = country_id.replace('COU_', '');\n\n            d3.selectAll('#'+country_id)\n            .attr('class', '');\n\n            d3.selectAll('#'+id)\n            .attr('class', '');\n        }\n\n        function mapTotal(){\n\n            reset();\n\n            $('#map_total').addClass('rdiv_selected');\n            $('#map_total_eu').removeClass('rdiv_selected');\n\n            $('#note').text('Data for 37 European countries which provide monthly information to UNHCR. To the extent possible, the figures reflect first time asylum applications, but some of the statistics are likely to include repeated applications (same or different country).');\n\n            var totalYear = d3.sum(latestYearQuery, function(d){\n                return d.Total;\n            });\n\n            $('#total').text(grandTotal);\n            $('#totalYear').text(totalYear);\n\n            var between = 'between ' + minMonthStr + ' and ' + maxMonthStr;\n            var subtitle = 'From ' + minMonthStr + ' to ' + maxMonthStr;\n\n            $('#total_label').text(between);\n            $('#subtitle').text(subtitle);\n\n            eu = 0;\n\n            $.each(query, function (index, data) {\n                d3.selectAll('#COU_'+data.CountryCode)\n                .transition()\n                .duration(1500)\n                .attr('fill', '#FAFAFA');\n\n                d3.selectAll('#'+data.CountryCode)\n                .attr('opacity', '1');\n\n            });\n\n            circles.data(mapArray).transition().duration(1200).attr('r', function (d) {if(r(d.Total)>0) { return r(d.Total) } else { return 0; } })\n            .attr('opacity', function(d){\n                if(d.Total>0){ return 1; } else { return 0; };\n            });\n\n       // update piechart\n       pie.series[0].data[0].update({y: top2}, false);\n       pie.series[0].data[1].update({y: top5}, false);\n       pie.series[0].data[2].update({y: others}, false);\n       pie.redraw();\n\n       $('#t1_str').text('Germany & Sweden');\n       $('#t2_str').text('Hungary, Austria, Netherlands, Greece, Denmark');\n       $('#t3_str').text('All others');\n\n       chart.series[3].setVisible (false, false);\n       chart.series[2].setVisible (false, false);\n       chart.series[1].setVisible (true, false);\n       chart.series[0].setVisible (true, false);\n       chart.redraw();\n\n       return false;\n   }\n\n   function mapTotalEu(){\n\n    reset();\n\n    $('#map_total_eu').addClass('rdiv_selected');\n    $('#map_total').removeClass('rdiv_selected');\n    $('#note').text('Data for the 28 EU Member States plus Norway and Switzerland (EU+). To the extent possible, the figures reflect first time asylum applications, but some of the statistics are likely to include repeated applications (same or different country).');\n\n    var totalYear = d3.sum(latestYearQuery, function(d){\n        return d.TotalEU;\n    });\n\n    $('#total').text(grandEUTotal);\n    $('#totalYear').text(totalYear);\n    var between = 'between ' + minMonthStr + ' and ' + maxMonthStr;\n    var subtitle = 'From ' + minMonthStr + ' to ' + maxMonthStr;\n\n    $('#total_label').text(between);\n    $('#subtitle').text(subtitle);\n\n    eu = 1;\n\n    circles.transition().duration(1200).attr('r', function (d) { if(r(d.TotalEU)>0) { return r(d.TotalEU) } else { return 0; } });\n\n    $.each(query, function (index, data) {\n        if(data.EU ==1){\n            d3.selectAll('#COU_'+data.CountryCode)\n            .transition()\n            .duration(1500)\n            .attr('fill', '#FAFAFA');\n\n            d3.selectAll('#'+data.CountryCode)\n            .attr('opacity', '1');\n\n        } else {\n            d3.selectAll('#COU_'+data.CountryCode)\n            .transition()\n            .duration(1500)\n            .attr('fill', '#d6d8d7');\n\n            d3.selectAll('#'+data.CountryCode)\n            .transition()\n            .duration(1500)\n            .attr('opacity', '0')\n            .attr('r', '0');\n\n        }\n    })\n\n       // update piechart\n       pie.series[0].data[0].update({y: topEU2}, false);\n       pie.series[0].data[1].update({y: topEU5}, false);\n       pie.series[0].data[2].update({y: othersEU}, false);\n       pie.redraw();\n\n       $('#t1_str').text('Germany & Sweden');\n       $('#t2_str').text('Hungary, Austria, Netherlands, Greece, Denmark');\n       $('#t3_str').text('All others');\n\n       chart.series[0].setVisible (false, false);\n       chart.series[1].setVisible (false, false);\n       chart.series[2].setVisible (true, false);\n       chart.series[3].setVisible (true, false);\n       chart.redraw();\n\n       return false;\n   }\n\n   function selectCountry(iso){\n        var countryData = {};\n        countryData.totalNC = [];\n        countryData.totalNCEU = [];\n        countryData.total = [];\n        countryData.totalEU = [];\n        var selectedCountry = iso;\n        var totalPrev = 0;\n        var total = 0;\n        var totalEUPrev = 0;\n        var month = '';\n\n        dataArray.forEach(function(d){\n\n            var month = d.Month; \n            var total = parseInt(d[selectedCountry]);\n\n            var totalEU = 0;\n            if(countryEUArr[selectedCountry]==1){\n              totalEU = total;  \n            }\n\n            countryData.total.push({x: new Date(month+'-01'), y: total + totalPrev });\n            countryData.totalEU.push({x: new Date(month+'-01'), y: totalEU + totalEUPrev });\n            countryData.totalNC.push({x: new Date(month+'-01'), y: total });\n            countryData.totalNCEU.push({x: new Date(month+'-01'), y: totalEU });\n\n            totalPrev = total + totalPrev;\n            totalEUPrev = totalEU + totalEUPrev;\n        });\n\n        var countries = svg.select('#countries')\n        .selectAll('path');\n\n        if(totalPrev>0){\n           chart.series[0].setVisible (false, false);\n           chart.series[1].setVisible (false, false);\n           chart.series[2].setVisible (false, false);\n           chart.series[3].setVisible (false, false);     \n\n           chart.series[4].setVisible (true, false);\n           chart.series[5].setVisible (true, false);\n           chart.series[4].setData(countryData.total);\n           chart.series[5].setData(countryData.totalNC); \n\n           // set line chart title\n            var country = query.filter(function(d){ return d.CountryCode == iso; })[0];\n            $('#linechart_title').text('Evolution of Asylum Applications in '+ country.CountryName);\n\n            // fade out other countries\n\n            countries.attr('opacity', function(d){ \n                if(d.id==selectedCountry){ \n                    return 1;\n                } else {\n                    return 0.8;\n                }\n            });\n\n            var circles = svg.selectAll('circle').attr('opacity', 0.4);\n\n            circles.attr('opacity', function(d){ \n                if(d.CountryCode==selectedCountry){ \n                    return 1;\n                } else {\n                    return 0.5;\n                }\n            });\n\n            var lYear = d3.sum(latestYearArray, function(d){\n                return d[selectedCountry];\n            });\n\n\n            var lTotal = d3.sum(dataArray, function(d){\n                return d[selectedCountry];\n            });\n\n            $('#total').html(lTotal);\n            $('#totalYear').text(lYear);\n\n        } else {\n\n           if(eu==1){\n                mapTotalEu();\n           } else {\n                mapTotal();          \n           }\n\n        }\n\n\n    }\n\n    function reset(){\n        svg.select('#countries')\n           .selectAll('path')\n           .attr('opacity', '1');\n\n           chart.series[4].setVisible (false, false);\n           chart.series[5].setVisible (false, false);\n           chart.series[0].setVisible (true, false);\n           chart.series[1].setVisible (true, false);\n           $('#linechart_title').text('Evolution of Asylum Applications');\n    }\n\n   $(window).resize(function() {\n    var w = $('#map').width();\n    svg.attr('width', w);\n    svg.attr('height', w * height / width);\n});\n\n   $('#map').mousemove(function(event){\n    var m = $('#map');\n    var offset = m.offset();\n    $('#popup').css('left', event.pageX-offset.left+20);\n    $('#popup').css('top', event.pageY-offset.top+5);\n});\n\n   function numberFormat(n) {\n    var parts=n.toString().split('.');\n    return parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') + (parts[1] ? '.' + parts[1] : '');\n}\n\n    //**************************\n    // PIE CHART\n    //**************************\n\n    var top2 = latestRecord.DEU + latestRecord.SWE;\n    var top5 = latestRecord.AUT + latestRecord.HUN + latestRecord.NLD + latestRecord.GRC + latestRecord.DNK;\n    var others = grandTotal - top2 - top5;\n\n    var topEU2 = latestRecord.DEU + latestRecord.SWE;\n    var topEU5 = latestRecord.AUT + latestRecord.HUN + latestRecord.NLD + latestRecord.GRC + latestRecord.DNK;\n    var othersEU = grandEUTotal - topEU2 - topEU5;\n\n    var pie = new Highcharts.Chart({\n        chart: {\n            renderTo: 'piechart',\n                //Problem only occurs on pie\n                type: 'pie',\n                animation: false,\n                backgroundColor:'rgba(255, 255, 255, 0.0)',  \n                plotBackgroundColor: null,\n                plotBorderWidth: null,\n                plotShadow: false,\n                marginBottom: 0,\n                marginLeft: 0,\n                marginRight: 0,\n                marginTop: 5,\n                spacingTop: 0,\n                spacingBottom: 0,\n                spacingLeft: 0,\n                spacingRight: 0\n            },\n            title: {\n                text: ''\n            },\n            credits: {enabled: false},\n            tooltip: {\n                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>',\n                enabled: false\n            },\n            plotOptions: {\n                pie: {\n                  size:'100%',\n                  showInLegend: false,\n                  startAngle: 0,\n                  allowPointSelect: false,\n                  cursor: 'pointer',\n                  center: ['45%', '50%'],\n                  dataLabels: {\n                    distance: -25,\n                    style:{ \n                        width: '40px',\n                        color: '#000',\n                        fontColor: '#000'\n                    },\n                    enabled: true,\n                    softConnector: false,\n                    connectorColor: 'grey',\n                    format: '<span style=\"font-size: 10px; color: #000; font-weight: bold;\">{point.percentage:.0f} %</span>' //\n                }\n            }\n        },\n        legend: {\n            enabled: true\n        },\n        series: [{\n            type: 'pie',\n            data: [\n            {name: 'Germany & Sweden', color: '#8c3b65', y: top2},\n            {name: 'Next Top 5: Hungary, Austria, Netherlands, Greece, Denmark', color: '#d6b3c3', y: top5 },\n            {name: 'All others', color: '#cacccb', y: others}\n            ]\n        }]\n    });\n\n\n//**************************\n// LINE CHART\n//**************************\nvar chart = new Highcharts.Chart({\n    chart: {\n        renderTo: 'linechart',\n        animation: false,\n        backgroundColor:'rgba(255, 255, 255, 0.0)',  \n        type: 'area',\n        marginBottom: 35,\n        marginRight: 45\n    },\n    xAxis: {\n        type: 'datetime',\n        dateTimeLabelFormats: { //custom date formats for different scales\n            second: '%H:%M:%S',\n            minute: '%H:%M',\n            hour: '%H:%M',\n            day: '%e. %b',\n            week: '%e. %b',\n            month: '%b-%y', //month formatted as month only\n            year: '%b %Y'\n        }\n    },\n    title: { text: ''},\n    yAxis: {\n        title: { text: ''},\n        opposite: true,\n        gridLineWidth: 0.5,\n        lineColor: '#666',\n        tickColor: '#666',\n        tickWidth: 0,\n        labels: {\n            y: 3,\n            formatter: function(){\n                return numberFormat(this.value/1000)+'k';\n            },\n            enabled: true,\n            style: {\n                color: '#666',\n                font: '10px Arial'\n                }\n            },\n        },\n    legend: {enabled: false},\n    credits: {\n        enabled: false\n    },\n    tooltip: {\n        shared: true,\n        crosshairs: true,\n        enabled: true,\n        shadow: false,\n        animation: true,\n        borderRadius: 2,\n        borderWidth: 0,\n        useHTML: true,\n        hideDelay: 0,\n        style: {\n            color: '#333333',\n            padding: '0px',\n            font: '9px Arial',\n            lineHeight: '1.5',\n            textAlign: 'center'\n        },\n        formatter: function() {\n            var string = '<div style=\"font-size: 10px; background-color: #5C5C5C; border: 1px #333333 solid; color: white;padding: 0px 3px 0px 2px; z-index: 555\"><table cellspacing=\"0\" cellpadding=\"1px\" class=\"linetooltip\" width=\"150px\">';\n            var tot = 0;\n             $.each(this.points, function (i, point) {\n                if((point.series.name=='Monthly')||(point.series.name=='Cumulative')){\n                    string = string + '<tr><td style=\"font-weight: normal; font-size: 9px\"><span style=\"background-color: '+point.series.color+'; border: 1px solid grey; margin-right: 3px\">&nbsp;&nbsp;</span>'+ point.series.name +'</td>';\n                    string = string + '<td><span style=\"font-size: 7px; color:#D6D6D6;\">' +Highcharts.dateFormat('%b 20%y',point.x)+'</span></td><td align=\"right\"><b>'+ numberFormat(point.y) +'</b></td></tr>';\n                }\n                var d = Highcharts.dateFormat('20%y-%m-01',point.x);\n\n                if(mapMonth[d]){\n                    $.each(mapMonth[d], function (index, data) {\n                        if(data.EU == 1){\n                            d3.selectAll('#'+index)\n                            .attr('r', function () { if(r(data)>0) { return r(data) } else { return 0; } });\n                        } else {\n                            d3.selectAll('#'+index)\n                            .attr('r', function () { if(r(data)>0) { return r(data) } else { return 0; } });\n                        }\n                    });\n                }\n            });\n            string=string+'</table></div>';\n            return string;\n        }\n    },\n    plotOptions: {\n        series: {\n            animation: false\n        },\n        area: {\n            fillOpacity: 0.1,\n            smoothed: true,\n            lineWidth: 1.7,\n            strokeOpacity: 0.1,\n            animation: false,\n            dataLabels: {\n                enabled:true,\n                color: 'grey',\n                y:-25,\n                formatter: function() {\n                    if(Highcharts.dateFormat('%b', new Date(this.x))=='Jun'){\n                        return   '<div style=\\'color: red;\\'>20'+Highcharts.dateFormat('%y', new Date(this.x))+'</div>';}\n                }\n            },\n            marker: {\n                enabled: true,\n                symbol: 'square',\n                radius: 2,\n                states: {\n                    hover: {\n                        enabled: true,\n                        radius: 3\n                    }\n                }\n            },\n            shadow: {\n                color: '#808080',\n                width: 3,\n                opacity: 0.02,\n                offsetY: 4,\n                offsetX: 0\n            },\n            states: {\n                hover: {\n                    lineWidth: 1.5\n                }\n            }\n        },\n        line: {\n            fillOpacity: 0.1,\n            fillColor: 'rgba(0,0,0,0.1)',\n            lineColor: 'grey',\n            smoothed: false,\n            lineWidth: 1,\n            strokeOpacity: 0.1,\n            marker: {\n                enabled: true,\n                symbol: 'square',\n                fillColor: '#8c3b65',\n                radius: 2,\n                states: {\n                    hover: {\n                        enabled: true,\n                        radius: 3\n                    }\n                }\n            },\n            shadow: {\n                color: '#808080',\n                width: 3,\n                opacity: 0.02,\n                offsetY: 4,\n                offsetX: 0\n            },\n            states: {\n                hover: {\n                    lineWidth: 1.5\n                }\n            }\n        },\n        column: {\n            pointPadding: 0,\n            borderWidth: 1.2,\n            borderColor: '#414141'\n        }\n    },\n    series: [\n        {type: 'area', color: '#8c3b65', name: 'Cumulative', data: monthData.total },\n        {type: 'column', color: '#474747', name: 'Monthly', data: monthData.totalNC },\n        {type: 'area', color: '#8c3b65', name: 'Cumulative', data: monthData.totalEU },\n        {type: 'column', color: '#474747', name: 'Monthly', data: monthData.totalNC },\n        {type: 'area', color: '#8c3b65', name: 'Cumulative', data: [] },\n        {type: 'column', color: '#474747', name: 'Monthly', data: [] }\n    ]\n});\n\nchart.series[2].hide();\nchart.series[3].hide();\n\n$( document ).ready(function() {\n\n    $('#map_total').on('click', mapTotal);\n    $('#map_total_eu').on('click', mapTotalEu);\n\n        // browser sizes\n        // $('.rightpanel').height($('#map').height()-10);\n        var mapHeight = $('#map').height();\n        var rightHeight = $('.rightpanel').height();\n        var lineHeight = $('#linechart').height();\n        var linePos = $('.linechart').position();\n        var diff = rightHeight - mapHeight;\n        var newHeight = rightHeight - linePos.top -41;\n\n        // $('#linechart').height(lineHeight - diff - 15);\n        var lineHeight = $('#linechart').height();\n        // chart.setSize($('#linechart').width(), newHeight, doAnimation = false);\n\n        var rightWidth = $('.container').width();\n        if(rightWidth<=872){\n           $('#buttonhelper').hide();\n           $('#linecharthelper').hide();\n           $('.buttonsub').css('font-size','8px');\n       } else {\n           $('#buttonhelper').show();\n           $('#linecharthelper').show();  \n           $('.buttonsub').show();\n       }\n       if(rightWidth>360){\n           $('.buttonsub').css('font-size','10px');\n       } \n\n       if(rightWidth<300){\n           $('#total').css('font-size','35px');\n           $('#totalYear').css('font-size','28px');\n       } \n\n   });\n\n\n(function() {\n    var oldVersion = chart.tooltip.hide;\n    chart.tooltip.hide = function() {\n        // do some stuff\n        var result = oldVersion.apply(this, arguments);\n        // do some more stuff\n        if(eu==0){\n            circles.transition().delay(700).duration(800).attr('r', function (d) { if(r(d.Total)>0) { return r(d.Total) } else { return 0; } });\n        } else {\n            circles.transition().delay(700).duration(800).attr('r', function (d) {  if(r(d.TotalEU)>0) { return r(d.TotalEU) } else { return 0; } });\n        };\n        return result;\n    };\n})();\n\n}\n});\n\nfunction sum(ob1, ob2) {\n  let sum = {};\n\n  Object.keys(ob1).forEach(key => {\n    if (ob2.hasOwnProperty(key)) {\n      sum[key] = parseInt(ob1[key]) + parseInt(ob2[key])\n  }  \n})\n  return sum;\n}\n\nfunction sumObj( obj ) {\n  var sum = 0;\n  for( var el in obj ) {\n    if(( obj.hasOwnProperty( el ))&& (el!='Month')) {\n      sum += parseFloat( obj[el] );\n  }\n}\nreturn sum;\n}\n\n\n"]}